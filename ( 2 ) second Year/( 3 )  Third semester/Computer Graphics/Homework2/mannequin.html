<!DOCTYPE html>

<html>
	<head>
		<style>
			body {color: black; text-shadow: 0 0 4px gray; font-family: Calibri;}
			h1   {position: fixed; z-index: 10; top: 0; left: 0; text-align: center; width: 100%;}
			div  {position: fixed; z-index: 10; bottom: 1em; left: 1em; font-size: 1.5em; font-style: italic;}
		</style>
		<script type="importmap">
		{
			"imports": {
				"three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.js",
				"three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/",
				"mannequin": "https://cdn.jsdelivr.net/npm/mannequin-js@latest/src/mannequin.js"
			}
		}
		</script>
	</head>

	<body>
	
		<!-- Сложете реално заглавие -->
		<h1>Заглавие на сцената</h1>  
		
		<!-- Сложете описание на сцената (опитайте с рима) -->
		<div>
			Сложете тук един куплет,<br>
			кажете в него де що става,<br>
			a изборът ви на сюжет &ndash;<br>
			без милост да ни грабва.
		</div>
		
		<script type="module">

			import * as MANNEQUIN from "mannequin";
			import * as THREE from 'three';
			MANNEQUIN.createStage( animate ); 
			var a= 0;
			var count =0;
			var output = 0;
			var figure = new MANNEQUIN.Male();
			var speed = 100;

			var a1 = {"version":7,"data":[[0,-1.7,0],[-8.9,-90,0],[0,0,-12.1],[0,0,2.1],[6,0,19.8],[43.8],[-6,-6,-9.8],[-6,0,-17.7],[24.7],[6,6,-32.1],[7,-0.6,-12.8],[24.4],[5,0,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-7,0.6,-27.8],[41.5],[-5,0,0],[90,-70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}
			var a2 ={"version":7,"data":[[-0.7,-3.4,0],[-8.9,-90,0],[-9.6,-38.1,-15.5],[-0.7,17.8,0.3],[6,0,32.1],[57.4],[-2,16.9,-10.1],[-10.1,-12.6,-11.9],[44.8],[5.5,6.4,-44],[15.7,-3.9,-23.6],[48.8],[-22.3,0,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-2,-23.3,111.3],[147.5],[24.6,0,0],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}

			var a3 ={"version":7,"data":[[-0.7,-3.4,0],[-8.9,-90,0],[-9.6,-38.1,-15.5],[-0.7,17.8,0.3],[6,0,32.1],[57.4],[-2,16.9,-10.1],[-10.1,-12.6,-11.9],[44.8],[5.5,6.4,-44],[15.7,-3.9,-23.6],[48.8],[-22.3,0,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-2,-23.3,111.3],[147.5],[24.6,0,0],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}

			var a4 ={"version":7,"data":[[-0.7,-3.4,0],[-8.9,-90,0],[-14,-48.5,-18.5],[-0.7,17.8,0.3],[6,0,32.1],[57.4],[0.8,-28,3.8],[-4.4,14.6,-12],[44.8],[20.1,20.3,-35.7],[21.1,-57.8,7.1],[113.5],[22.1,0,0],[-90,70,81.2,0,10,0,25.5],[5.8,1,9.9,0,21.4,0,10],[0,0,10,0,42.4,0,10],[-2.6,-0.5,10,0,42.4,0,10],[-8.4,-1.5,9.9,0,37.9,0,0.1],[-14.8,-49.2,64.1],[60.5],[51.9,0,0],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}

			var a5 = {"version":7,"data":[[-0.7,-3.4,0],[-8.9,-43.9,0],[-6.7,-29,-13.9],[-0.4,-11.8,0.6],[9.4,-5.3,32.3],[57.4],[0.9,-30,-19.1],[-13.3,-26.5,-13],[44.8],[21.4,22,-36.2],[57.8,12.5,2.2],[113.5],[22.1,0,0],[-90,70,81.2,0,10,0,25.5],[5.8,1,9.9,0,21.4,0,10],[0,0,10,0,42.4,0,10],[-2.6,-0.5,10,0,42.4,0,10],[-8.4,-1.5,9.9,0,37.9,0,0.1],[33.9,24.6,67.5],[23.8],[51.9,0,0],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}

			var a6 = {"version":7,"data":[[-0.7,-3.4,0],[-8.9,-43.9,-0.2],[-6.7,-29,-20.1],[-0.4,-11.8,0.6],[9.4,-5.3,32.3],[57.4],[19,25.7,-18.3],[-13.3,-26.5,-13],[28.1],[21.4,22,-30.3],[12,7.3,-25.6],[58.8],[22.1,0,0],[-90,70,81.2,0,10,0,25.5],[5.8,1,9.9,0,21.4,0,10],[0,0,10,0,42.4,0,10],[-2.6,-0.5,10,0,42.4,0,10],[-8.4,-1.5,9.9,0,37.9,0,0.1],[-63,21.7,115.4],[23.8],[51.9,0,0],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}

			var a7 = {"version":7,"data":[[-0.7,-3.4,0],[-9.9,-83.3,-1.2],[-4.3,-22.9,-19.1],[-0.6,10.7,0.6],[9.4,-5.3,28.1],[57.4],[11.4,13.5,-22.2],[-13.3,-26.5,-8],[58.6],[21.4,22,-22.8],[12,7.3,-28],[86.3],[22.1,0,0],[-90,70,81.2,0,10,0,25.5],[5.8,1,9.9,0,21.4,0,10],[0,0,10,0,42.4,0,10],[-2.6,-0.5,10,0,42.4,0,10],[-8.4,-1.5,9.9,0,37.9,0,0.1],[-63,21.7,16.1],[9.9],[51.9,0,0],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}

			var a8={"version":7,"data":[[1.1,-3.7,0],[0,-90,0],[-7.4,-33.9,-13.2],[-0.7,21.3,0.6],[14.1,25.2,23.2],[57.4],[-8.9,-10.6,-25],[-14.5,8.5,8.6],[59.2],[-6.3,-30.6,-18.2],[16.7,-71.8,41.4],[86.3],[22.1,0,0],[-90,70,81.2,0,10,0,25.5],[5.8,1,9.9,0,21.4,0,10],[0,0,10,0,42.4,0,10],[-2.6,-0.5,10,0,42.4,0,10],[-8.4,-1.5,9.9,0,37.9,0,0.1],[-17.2,-67.4,42],[81.4],[51.9,0,0],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}

			var a9= {"version":7,"data":[[1.1,-3.7,0],[0,-56.5,0],[2.4,11.7,-11.2],[-0.5,-0.4,0.6],[14.7,18.1,23.4],[60.2],[-20.6,-22.3,-22.6],[-7.3,-34.6,13.9],[50.1],[-6.3,-30.6,-44.4],[70.5,-53.5,58.8],[86.3],[22.1,0,0],[-90,70,81.2,0,10,0,25.5],[5.8,1,9.9,0,21.4,0,10],[0,0,10,0,42.4,0,10],[-2.6,-0.5,10,0,42.4,0,10],[-8.4,-1.5,9.9,0,37.9,0,0.1],[90,-65.9,142.6],[62.1],[51.9,0,0],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}

			var a10 ={"version":7,"data":[[1.1,-3.7,0],[0,-10.5,0],[12.8,48.7,-16.7],[0.1,-45,0.8],[14.7,18.1,23.4],[60.2],[-20.6,-22.3,-22.6],[-7.3,-34.6,13.9],[50.1],[-6.3,-30.6,-44.4],[70.5,-53.5,44.6],[60.8],[22.1,0,0],[-90,70,81.2,0,10,0,25.5],[5.8,1,9.9,0,21.4,0,10],[0,0,10,0,42.4,0,10],[-2.6,-0.5,10,0,42.4,0,10],[-8.4,-1.5,9.9,0,37.9,0,0.1],[47.7,-60.9,71],[76.6],[51.9,41,-54.7],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}

			var a11={"version":7,"data":[[1.1,-3.7,0],[0,-10.5,0],[12.8,48.7,-16.7],[-0.3,-20.7,0.6],[11,24.2,30.4],[52.2],[-11.7,7.8,-16],[-34.9,-56.7,-8.1],[47.2],[30.6,14.2,-19.5],[72.1,-54.5,45.9],[116.5],[22.1,-21.5,0],[-90,70,81.2,0,10,0,25.5],[5.8,1,9.9,0,21.4,0,10],[0,0,10,0,42.4,0,10],[-2.6,-0.5,10,0,42.4,0,10],[-8.4,-1.5,9.9,0,37.9,0,0.1],[-55.9,-1.7,-2.2],[64.1],[0,-11.4,-39],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}
			var a12={"version":7,"data":[[-0.4,-5.5,0],[0,-77.5,0],[-1,-5.7,-11],[-0.5,0.6,0.6],[25,-10.9,36.9],[49.5],[-11.7,7.8,-22.2],[-9.4,-35.8,15.8],[69.3],[30.6,14.2,-50.5],[41.6,-19.7,26.3],[84.7],[22.1,-73.8,0],[-90,70,81.2,0,10,0,25.5],[5.8,1,9.9,0,21.4,0,10],[0,0,10,0,42.4,0,10],[-2.6,-0.5,10,0,42.4,0,10],[-8.4,-1.5,9.9,0,37.9,0,0.1],[-87.7,-0.3,-2.7],[30],[29.2,-30.1,12.8],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}

			var a13= {"version":7,"data":[[-0.4,-5.5,0],[0,-15.8,0],[-3.8,-19.3,-11.6],[-0.2,-28.9,0.6],[37.8,-48,38.9],[49.5],[-11.7,7.8,-35.3],[5.9,-61.5,27.6],[69.3],[30.6,14.2,-50.5],[53.1,-13.9,-25.6],[141],[22.1,-73.8,0],[-90,70,81.2,0,0,0,25.5],[5.8,1,9.9,0,21.4,0,10],[0,0,10,0,42.4,0,10],[-2.6,-0.5,10,0,42.4,0,10],[-8.4,-1.5,9.9,0,37.9,0,0.1],[-87.7,-0.3,36.6],[10.6],[-80.9,78.6,7.8],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}

			var a14 ={"version":7,"data":[[-0.4,-9,0],[0,-65.6,0],[-9.1,-39.5,-14.2],[-0.5,8.1,1.5],[13.4,1.7,56],[91.1],[-20.1,12.3,-27.7],[-12.3,-26.1,14.4],[84.9],[-3.1,-14.6,-70.7],[-1.5,13.3,79.6],[19.6],[22.1,-73.8,23.4],[-0.9,87,-28.5,0,19.2,0,25.5],[5.8,1,9.9,0,21.4,0,10],[0,0,10,0,42.4,0,10],[-2.6,-0.5,10,0,42.4,0,10],[-8.4,-1.5,9.9,0,37.9,0,0.1],[-109.2,-13.6,-34.9],[137.7],[-138.8,64,63.5],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}
			var a16 = {"version":7,"data":[[-0.4,-9,0],[0,-65.6,0],[-9.1,-39.5,-14.2],[-0.5,8.1,1.5],[13.4,1.7,56],[91.1],[-20.1,12.3,-27.7],[-12.3,-26.1,14.4],[84.9],[-3.1,-14.6,-70.7],[-1.5,13.3,79.6],[19.6],[22.1,-73.8,23.4],[-0.5,87,-27.4,0,35.9,0,25.5],[5.8,1,74.5,0,0,0,0],[0,0,72.8,0,0.1,0,10],[-2.6,-0.5,74.6,0,0.1,0,0.1],[-8.4,-1.5,70.7,0,0.1,0,0.1],[-109.2,-13.6,-34.9],[137.7],[-138.8,64,63.5],[164.7,-10.3,134.8,0,15.5,0,26],[0,0,38,0,42.9,0,61],[0,0,55,0,36.3,0,65.6],[0,0,45.6,0,39.7,0,65.2],[0,0,45.7,0,27.2,0,51.8]]}
			var animation = [a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12,a13,a14,a16,a14,a16]
			var speeds    = [30,10,10,30,20,20,20,10,10,20,10,30,30,10,10,10,10,10,10]
		
			
			figure.posture = a1;

			// figure.r_leg.hide();
			var sword = new THREE.Group(); 
			var material = new THREE.MeshPhongMaterial({color:'crimson',shininess:200});
			var obj = new THREE.Mesh(new THREE.CylinderGeometry(.5,.5,5,32), material);
			var Sharp = new THREE.Mesh(new THREE.BoxGeometry(1,20,2), material);
			obj.position.set(-0.9,1,-2);
			obj.castShadow = true;			
			
			Sharp.position.set(-0.9,20/2+3,-2);
			Sharp.castShadow = true;	
			
			sword.add(Sharp);
			sword.add(obj);
			sword.rotation.set(Math.PI/2,0,0);
			var clone = sword.clone();
			clone.visible = false;
			figure.r_wrist.attach(clone);
			var flag = false;
			function animate( time )
			{
				
				a += 1/speed;
				if(a >= 0.99){
					count++;
					a = 0;
				}

				if(count <animation.length-1){
					output =((Math.pow(a,2))/(Math.pow(a,2)+Math.pow((1-a),2)));
					
					if(count == 1 &&!flag){
						clone.visible = true;
						flag = true;
					}
					speed = speeds[count];
					figure.posture = MANNEQUIN.blend(animation[count],animation[count+1], output );
				}

			}

		</script>
	</body>
</html>